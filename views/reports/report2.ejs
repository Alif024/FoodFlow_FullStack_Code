<%- include("../partials/head", { title, stylesheet }) %>
<main class="main-container report-page-container">
  <section class="content-card customer-table-card report-page-card">
    <div class="panel-header customer-header">
      <div>
        <span class="panel-badge">Report 2</span>
        <h1 class="panel-title">Best Selling Menus</h1>
        <p class="panel-description">Top menus by quantity sold and sales amount.</p>
      </div>
    </div>

    <form method="get" action="/reports/report2" class="customer-form-grid report-form">
      <label class="customer-form-field">
        <span>Start Date</span>
        <input type="date" name="start_date" value="<%= filters.startDate %>" />
      </label>
      <label class="customer-form-field">
        <span>End Date</span>
        <input type="date" name="end_date" value="<%= filters.endDate %>" />
      </label>
      <label class="customer-form-field">
        <span>Order Status</span>
        <select name="order_status">
          <option value="" <%= !filters.orderStatus ? "selected" : "" %>>All (except cancelled)</option>
          <option value="pending" <%= filters.orderStatus === "pending" ? "selected" : "" %>>pending</option>
          <option value="confirmed" <%= filters.orderStatus === "confirmed" ? "selected" : "" %>>confirmed</option>
          <option value="paid" <%= filters.orderStatus === "paid" ? "selected" : "" %>>paid</option>
          <option value="cancelled" <%= filters.orderStatus === "cancelled" ? "selected" : "" %>>cancelled</option>
        </select>
      </label>
      <label class="customer-form-field">
        <span>Limit</span>
        <input type="number" name="limit" min="1" step="1" value="<%= filters.limit %>" />
      </label>
      <div class="customer-form-actions">
        <button type="submit" class="customer-btn customer-btn--primary">Generate</button>
      </div>
    </form>

    <div class="customer-table-wrap">
      <table class="customer-table">
        <thead>
          <tr>
            <th>menu_id</th>
            <th>menu_name</th>
            <th>category</th>
            <th>total_quantity</th>
            <th>total_orders</th>
            <th>total_sales</th>
          </tr>
        </thead>
        <tbody>
          <% if (!rows || !rows.length) { %>
            <tr><td colspan="6">No data</td></tr>
          <% } else { %>
            <% rows.forEach((row) => { %>
              <tr>
                <td><%= row.menu_id %></td>
                <td><%= row.menu_name %></td>
                <td><%= row.category_name || "-" %></td>
                <td><%= row.total_quantity %></td>
                <td><%= row.total_orders %></td>
                <td><%= row.total_sales %></td>
              </tr>
            <% }) %>
          <% } %>
        </tbody>
      </table>
    </div>
  </section>
</main>
<%- include("../partials/foot", { script }) %>
